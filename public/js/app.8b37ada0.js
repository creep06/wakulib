(function(t){function e(e){for(var a,i,u=e[0],s=e[1],l=e[2],p=0,f=[];p<u.length;p++)i=u[p],r[i]&&f.push(r[i][0]),r[i]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a]);c&&c(e);while(f.length)f.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],a=!0,u=1;u<n.length;u++){var s=n[u];0!==r[s]&&(a=!1)}a&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},r={app:0},o=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],s=u.push.bind(u);u.push=e,u=u.slice();for(var l=0;l<u.length;l++)e(u[l]);var c=s;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),r=n("2f62"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},i=[],u={name:"app"},s=u,l=(n("5c0b"),n("2877")),c=Object(l["a"])(s,o,i,!1,null,null,null),p=c.exports,f=n("8c4f"),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h1",[t._v("メイン画面だ！")]),n("main-navbar"),n("main-table"),n("main-navbar-bottom")],1)},d=[],h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h1",[t._v("Navbar")]),n("button",{on:{click:t.logout}},[t._v("ログアウト")])])},v=[],b=n("0e44"),_={loggedIn:!1,userId:"",token:""};a["a"].use(r["a"]);var g={LOGIN:function(t,e){t.loggedIn=!0,t.userId=e.user_id,t.token=e.token},LOGOUT:function(t){Object.assign(t,JSON.parse(localStorage.getItem("initialState")))}},w=new r["a"].Store({state:_,mutations:g,actions:{},getters:{},plugins:[Object(b["a"])({key:"wakulib"})]}),y={name:"Navbar",methods:{logout:function(){var t=this;this.$axios.post("/api/logout").then(function(e){w.commit("LOGOUT"),t.$router.push({path:"/login"})}).catch(function(t){})}}},O=y,x=Object(l["a"])(O,h,v,!1,null,"32e3b28f",null),k=x.exports,j=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},$=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h1",[t._v("navbar_bottom")])])}],E={name:"navbar-bottom"},I=E,S=Object(l["a"])(I,j,$,!1,null,"43e960d9",null),N=S.exports,P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h1",[t._v("Table")]),n("table",[t._m(0),n("tbody",t._l(t.books,function(e){return n("tr",{key:e.id},[n("th",[t._v(t._s(e.title))]),n("th",[t._v(t._s(e.author))]),n("th",[t._v(t._s(e.volume))]),n("th",[t._v(t._s(e.chapter))])])}),0)])])},T=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",[t._v("名前")]),n("th",[t._v("著者")]),n("th",[t._v("巻数")]),n("th",[t._v("話数")])])])}],q=(n("ac6a"),{name:"Table",data:function(){return{books:[]}},methods:{init:function(){var t=this;this.$axios.get("/api/books/all/"+w.state.userId).then(function(e){e.data.forEach(function(e){t.books.push({id:e.id,title:e.title,phonetic:e.phonetic,author:e.author,volume:e.volume,chapter:e.chapeter,completed:e.completed})})}).catch(function(t){})}},mounted:function(){this.init()}}),A=q,L=Object(l["a"])(A,P,T,!1,null,"6977931f",null),G=L.exports,J={name:"Table",components:{"main-navbar":k,"main-table":G,"main-navbar-bottom":N}},M=J,z=Object(l["a"])(M,m,d,!1,null,"4693ef96",null),B=z.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",{directives:[{name:"show",rawName:"v-show",value:t.isError,expression:"isError"}]},[t._v("認証に失敗しました。")]),n("form",{on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[n("h1",[t._v("ログイン")]),t._v("\n    メールアドレス: "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],attrs:{type:"email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}}),t._v("\n    パスワード: "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),n("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("ログイン")])])])},C=[],D={name:"Login",data:function(){return{isError:!1,email:"",password:""}},methods:{login:function(){var t=this;this.$axios.post("/api/login",{email:this.email,password:this.password}).then(function(e){var n=e.data.user_id,a=e.data.access_token;t.$axios.defaults.headers.common["Authorization"]="Bearer "+a,w.commit("LOGIN",{user_id:n,token:a}),console.log(w.state.userId),console.log(w.state.token),t.$router.push({path:"/"})}).catch(function(e){t.isError=!0})}}},F=D,H=Object(l["a"])(F,U,C,!1,null,"50bc52ba",null),K=H.exports;a["a"].use(f["a"]);var Q=new f["a"]({mode:"history",base:"/",routes:[{path:"/",name:"main",component:B,meta:{requiresAuth:!0}},{path:"/login",name:"login",component:K,meta:{requiresNoAuth:!0}}]});Q.beforeEach(function(t,e,n){t.matched.some(function(t){return t.meta.requiresAuth})&&(w.state.loggedIn?n():n({path:"/login",query:{redirect:t.fullPath}})),t.matched.some(function(t){return t.meta.requiresNoAuth})&&(w.state.loggedIn?n({path:"/",query:{redirect:t.fullPath}}):n())});var R=Q,V=n("bc3a"),W=n.n(V);window.state=w.state,a["a"].prototype.$axios=W.a,a["a"].use(r["a"]),a["a"].config.productionTip=!1,new a["a"]({router:R,render:function(t){return t(p)},created:function(){localStorage.setItem("initialState",JSON.stringify(_)),w.state.loggedIn&&(W.a.defaults.headers.common["Authorization"]="Bearer "+w.state.token)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var a=n("5e27"),r=n.n(a);r.a},"5e27":function(t,e,n){}});
//# sourceMappingURL=app.8b37ada0.js.map